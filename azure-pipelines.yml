variables:
- name: BuildParameters.workingDirectory
  value: ''
- name: BuildParameters.workingDir
  value: ''
resources:
  repositories:
  - repository: self
    type: git
    ref: refs/heads/main

jobs:
  - job: Job_1
    displayName: "Run Test"
    pool:
      vmImage: windows-lates
    steps:
      - checkout: self
        clean: true
        fetchTags: false
      - task: NodeTool@0
        displayName: Node Installation
        inputs:
          versionSpec: 16.x
      - task: CmdLine@2
        displayName: Install PlayWright
        inputs:
          script: npm i && npx playwright install
          workingDirectory: $(BuildParameters.workingDirectory)
      - task: CmdLine@2
        displayName: Execute Test
        inputs:
          script: npx playwright test --browser=all
          
      - task: PublishHtmlReport@1
        displayName: Publish Html Report
        inputs:
          tabName: Playwright Report
          reportDir: playwright-report/${{ matrix.vmImage }}/index.html
