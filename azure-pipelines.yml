trigger:
- main
- master

pool:
  vmImage: windows-latest

steps:
- task: UseNode@1
  inputs:
    version: '16.x'
  displayName: 'Use Node.js 16.x'

- script: |
    npm ci
    npx playwright install --with-deps
    npx playwright test --browser=all
  displayName: 'Run Playwright tests on all browsers'

- task: PublishTestResults@2
  inputs:
    testRunner: JUnit
    testResultsFiles: '**/TEST-*.xml'
    searchFolder: 'playwright-test-results'
  
- task: PublishHtmlReport@1
  displayName: 'Publish Html Report'
  inputs:
      tabName: Playwright Report
      reportDir: playwright-report/windows/index.html